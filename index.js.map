{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nlet queryTracker = '';\nconst loadingIcon = document.querySelector('#loading');\n\nexport async function getImages(userInput, page) {\n  try {\n    loadingIcon.classList.add('loader');\n    const params = {\n      key: '49142387-370a201ec94f73d63c9116370',\n      q: userInput,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: page,\n      per_page: 40,\n    };\n    const output = await axios.get('https://pixabay.com/api/', { params });\n    if (output.data.hits.length === 0) {\n      iziToast.error({\n        title: '',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        maxWidth: '432px',\n        theme: 'dark',\n        messageSize: '16',\n        backgroundColor: '#ef4040',\n        messageColor: '#fafafb',\n        iconColor: '#fafafb',\n      });\n    }\n\n    loadingIcon.classList.remove('loader');\n    return output.data;\n  } catch (err) {\n    iziToast.error({\n      title: 'Unexpected Error',\n      message: `${err}`,\n      position: 'topRight',\n      maxWidth: '432px',\n      theme: 'dark',\n      messageSize: '16',\n      backgroundColor: '#ef4040',\n      messageColor: '#fafafb',\n      iconColor: '#fafafb',\n    });\n    loadingIcon.classList.remove('loader');\n  }\n}\n","export function imageTemplate(image) {\n  const {\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = image;\n  return `\n        <a class=\"gallery-item\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" data-source=\"${largeImageURL}\" />\n            <div class=\"image-features\">\n                <div class=\"features-text-field\">\n                    <p class=\"image-feature-text\">Likes</p>\n                    <p class=\"image-feature-text\">${likes}</p>\n                </div>\n                <div class=\"features-text-field\">\n                    <p class=\"image-feature-text\">Views</p>\n                    <p class=\"image-feature-text\">${views}</p>\n                </div>\n                <div class=\"features-text-field\">\n                    <p class=\"image-feature-text\">Comments</p>\n                    <p class=\"image-feature-text\">${comments}</p>\n                </div>\n                <div class=\"features-text-field\">\n                    <p class=\"image-feature-text\">Downloads</p>\n                    <p class=\"image-feature-text\">${downloads}</p>\n                </div>\n            </div>\n        </a>\n    `;\n}\n\nexport function imagesTemplate(images) {\n  return images.map(imageTemplate).join('');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { getImages } from './js/pixabay-api';\nimport { imagesTemplate } from './js/render-functions';\n\nconst refs = {\n  form: document.querySelector('.search-form'),\n  formInput: document.querySelector('.input-field'),\n  gallery: document.querySelector('.gallery'),\n  loadButton: document.querySelector('.load-btn'),\n};\nconst { form, formInput, gallery, loadButton } = refs;\n\nconst params = {\n  query: '',\n  page: 1,\n  total: 100,\n  perPage: 40,\n  maxPage: 10,\n};\n\nlet lightbox = new SimpleLightbox('.gallery a');\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n  if (formInput.value.trim() === '') {\n    formInput.value = '';\n    return;\n  }\n  document.querySelector('.gallery').innerHTML = '';\n  params.page = 1;\n  params.query = formInput.value.trim();\n  const images = await getImages(params.query, params.page);\n  params.total = images.totalHits;\n  params.maxPage = Math.ceil(params.total / params.perPage);\n  const markup = imagesTemplate(images.hits);\n  gallery.innerHTML = markup;\n  formInput.value = '';\n  lightbox.refresh();\n  checkLoadStatus();\n});\n\nloadButton.addEventListener('click', async e => {\n  loadMore();\n});\n\ngallery.addEventListener('click', e => {\n  e.preventDefault();\n  if (e.target === gallery) return;\n\n  lightbox.open(e.target);\n});\n\nasync function loadMore() {\n  params.page += 1;\n  loadButton.classList.add('visually-hidden');\n  const result = await getImages(params.query, params.page);\n  const markup = imagesTemplate(result.hits);\n  gallery.insertAdjacentHTML('beforeend', markup);\n  scrollPage();\n  lightbox.refresh();\n  checkLoadStatus();\n}\n\nfunction checkLoadStatus() {\n  if (params.page >= params.maxPage) {\n    loadButton.classList.add('visually-hidden');\n    iziToast.info({\n      title: '',\n      message: `We're sorry, but you've reached the end of search results.`,\n      position: 'topRight',\n      maxWidth: '432px',\n      messageSize: '16',\n    });\n  } else {\n    loadButton.classList.remove('visually-hidden');\n  }\n}\n\nfunction scrollPage() {\n  const info = gallery.firstElementChild.getBoundingClientRect();\n  const height = info.height;\n  scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["loadingIcon","getImages","userInput","page","params","output","axios","iziToast","err","imageTemplate","image","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imagesTemplate","images","refs","form","formInput","gallery","loadButton","lightbox","SimpleLightbox","e","markup","checkLoadStatus","loadMore","result","scrollPage","height"],"mappings":"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"}